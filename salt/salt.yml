---
- hosts: salt
  become: yes
  tasks:
  - name: "Install commond packages"
    apt:
      name: "{{ item }}"
      state: installed
    with_items:
      - vim
      - curl
      - wget
      - htop
      - aptitude
  
  - name: "Upgrade System"
    apt:
      update_cache: yes
      cache_valid_time: 3600

  - name: "Add  Salt Key"
    apt_key:
      url: "https://repo.saltstack.com/apt/ubuntu/16.04/amd64/latest/SALTSTACK-GPG-KEY.pub"
      state: present

  - name: "Add Salt repository"
    apt_repository:
      repo: deb http://repo.saltstack.com/apt/ubuntu/16.04/amd64/latest xenial main
      state: present

  - name: "Install Salt packages"
    apt:
      name: "{{ item }}"
      state: installed
      install_recommends: yes
    with_items:
      - salt-api
      - salt-cloud
      - salt-master
      - salt-minion
      - salt-ssh
      - salt-syndic

